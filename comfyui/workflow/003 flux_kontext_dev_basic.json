{"id":"7cbcec68-7fa6-47bb-a38a-da689949a001","revision":0,"last_node_id":192,"last_link_id":299,"nodes":[{"id":135,"type":"ConditioningZeroOut","pos":[250,200],"size":[240,26],"flags":{"collapsed":false},"order":14,"mode":0,"inputs":[{"localized_name":"Êù°‰ª∂","name":"conditioning","type":"CONDITIONING","link":237}],"outputs":[{"localized_name":"Êù°‰ª∂","name":"CONDITIONING","type":"CONDITIONING","links":[238]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.39","Node name for S&R":"ConditioningZeroOut"},"widgets_values":[]},{"id":173,"type":"PreviewImage","pos":[320,860],"size":[420,310],"flags":{},"order":16,"mode":0,"inputs":[{"localized_name":"ÂõæÂÉè","name":"images","type":"IMAGE","link":289}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.40","Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":124,"type":"VAEEncode","pos":[-20,400],"size":[240,50],"flags":{"collapsed":false},"order":15,"mode":0,"inputs":[{"localized_name":"ÂÉèÁ¥†","name":"pixels","type":"IMAGE","link":222},{"localized_name":"vae","name":"vae","type":"VAE","link":223}],"outputs":[{"localized_name":"Latent","name":"LATENT","type":"LATENT","links":[291,293]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.39","Node name for S&R":"VAEEncode"},"widgets_values":[]},{"id":42,"type":"FluxKontextImageScale","pos":[-50,570],"size":[270,30],"flags":{"collapsed":false},"order":13,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"IMAGE","link":251}],"outputs":[{"localized_name":"ÂõæÂÉè","name":"IMAGE","type":"IMAGE","links":[222,289]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.38","Node name for S&R":"FluxKontextImageScale"},"widgets_values":[]},{"id":146,"type":"ImageStitch","pos":[-390,570],"size":[270,150],"flags":{},"order":11,"mode":0,"inputs":[{"localized_name":"image1","name":"image1","type":"IMAGE","link":297},{"localized_name":"image2","name":"image2","shape":7,"type":"IMAGE","link":298},{"localized_name":"direction","name":"direction","type":"COMBO","widget":{"name":"direction"},"link":null},{"localized_name":"match_image_size","name":"match_image_size","type":"BOOLEAN","widget":{"name":"match_image_size"},"link":null},{"localized_name":"spacing_width","name":"spacing_width","type":"INT","widget":{"name":"spacing_width"},"link":null},{"localized_name":"spacing_color","name":"spacing_color","type":"COMBO","widget":{"name":"spacing_color"},"link":null}],"outputs":[{"localized_name":"ÂõæÂÉè","name":"IMAGE","type":"IMAGE","links":[251]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.40","Node name for S&R":"ImageStitch"},"widgets_values":["right",true,0,"white"]},{"id":35,"type":"FluxGuidance","pos":[250,90],"size":[240,58],"flags":{"collapsed":false},"order":18,"mode":0,"inputs":[{"localized_name":"Êù°‰ª∂","name":"conditioning","type":"CONDITIONING","link":292},{"localized_name":"ÂºïÂØº","name":"guidance","type":"FLOAT","widget":{"name":"guidance"},"link":null}],"outputs":[{"localized_name":"Êù°‰ª∂","name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[57]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.38","Node name for S&R":"FluxGuidance"},"widgets_values":[2.5]},{"id":177,"type":"ReferenceLatent","pos":[10,140],"size":[197.712890625,46],"flags":{},"order":17,"mode":0,"inputs":[{"localized_name":"conditioning","name":"conditioning","type":"CONDITIONING","link":294},{"localized_name":"latent","name":"latent","shape":7,"type":"LATENT","link":293}],"outputs":[{"localized_name":"Êù°‰ª∂","name":"CONDITIONING","type":"CONDITIONING","links":[292]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.41","Node name for S&R":"ReferenceLatent"},"widgets_values":[]},{"id":188,"type":"EmptySD3LatentImage","pos":[530,-140],"size":[310,106],"flags":{},"order":0,"mode":4,"inputs":[{"localized_name":"ÂÆΩÂ∫¶","name":"width","type":"INT","widget":{"name":"width"},"link":null},{"localized_name":"È´òÂ∫¶","name":"height","type":"INT","widget":{"name":"height"},"link":null},{"localized_name":"ÊâπÈáèÂ§ßÂ∞è","name":"batch_size","type":"INT","widget":{"name":"batch_size"},"link":null}],"outputs":[{"localized_name":"Latent","name":"LATENT","type":"LATENT","links":null}],"properties":{"cnr_id":"comfy-core","ver":"0.3.41","Node name for S&R":"EmptySD3LatentImage"},"widgets_values":[1024,1024,1]},{"id":175,"type":"MarkdownNote","pos":[-50,640],"size":[320,88],"flags":{},"order":1,"mode":0,"inputs":[],"outputs":[],"title":"How to enable multiple image input","properties":{},"widgets_values":["Click on the **Load image (from output)** node and use **Ctrl + B** to enable multiple image input support."],"color":"#432","bgcolor":"#653"},{"id":189,"type":"MarkdownNote","pos":[-400,1200],"size":[340,90],"flags":{},"order":2,"mode":0,"inputs":[],"outputs":[],"title":"About multi-round edit","properties":{},"widgets_values":["The **Load Image (from Outputs)** node allows you to fetch the last image from the output. Click on the **refresh** button to fetch the latest image or manually select an image from the dropdown list."],"color":"#432","bgcolor":"#653"},{"id":184,"type":"MarkdownNote","pos":[-960,40],"size":[510,400],"flags":{},"order":3,"mode":0,"inputs":[],"outputs":[],"title":"Model links","properties":{},"widgets_values":["[tutorial](http://docs.comfy.org/tutorials/flux/flux-1-kontext-dev)\n\n**diffusion model**\n\n- [flux1-dev-kontext_fp8_scaled.safetensors](https://huggingface.co/Comfy-Org/flux1-kontext-dev_ComfyUI/resolve/main/split_files/diffusion_models/flux1-dev-kontext_fp8_scaled.safetensors)\n\n**vae**\n\n- [ae.safetensors](https://huggingface.co/Comfy-Org/Lumina_Image_2.0_Repackaged/blob/main/split_files/vae/ae.safetensors)\n\n**text encoder**\n\n- [clip_l.safetensors](https://huggingface.co/comfyanonymous/flux_text_encoders/blob/main/clip_l.safetensors)\n- [t5xxl_fp16.safetensors](https://huggingface.co/comfyanonymous/flux_text_encoders/resolve/main/t5xxl_fp16.safetensors) or [t5xxl_fp8_e4m3fn_scaled.safetensors](https://huggingface.co/comfyanonymous/flux_text_encoders/resolve/main/t5xxl_fp8_e4m3fn_scaled.safetensors)\n\nModel Storage Location\n\n```\nüìÇ ComfyUI/\n‚îú‚îÄ‚îÄ üìÇ models/\n‚îÇ   ‚îú‚îÄ‚îÄ üìÇ diffusion_models/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ flux1-dev-kontext_fp8_scaled.safetensors\n‚îÇ   ‚îú‚îÄ‚îÄ üìÇ vae/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ae.safetensor\n‚îÇ   ‚îî‚îÄ‚îÄ üìÇ text_encoders/\n‚îÇ       ‚îú‚îÄ‚îÄ clip_l.safetensors\n‚îÇ       ‚îî‚îÄ‚îÄ t5xxl_fp16.safetensors ÊàñËÄÖ t5xxl_fp8_e4m3fn_scaled.safetensors\n```\n"],"color":"#432","bgcolor":"#653"},{"id":178,"type":"MarkdownNote","pos":[-30,-150],"size":[540,150],"flags":{},"order":4,"mode":0,"inputs":[],"outputs":[],"title":"About multiple images reference","properties":{},"widgets_values":["[English] In addition to using **Image Stitch** to combine two images at a time, you can also encode individual images, then concatenate multiple latent conditions using the **ReferenceLatent** node, thus achieving the purpose of referencing multiple images. You can use the **EmptySD3LatentImage** node on the right to connect to **KSamper** and customize the size of the **latent_image**."],"color":"#432","bgcolor":"#653"},{"id":191,"type":"LoadImage","pos":[-40,800],"size":[280,330],"flags":{},"order":5,"mode":4,"inputs":[{"localized_name":"ÂõæÂÉè","name":"image","type":"COMBO","widget":{"name":"image"},"link":null},{"localized_name":"ÈÄâÊã©Êñá‰ª∂‰∏ä‰º†","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"localized_name":"ÂõæÂÉè","name":"IMAGE","type":"IMAGE","links":[298]},{"localized_name":"ÈÅÆÁΩ©","name":"MASK","type":"MASK","links":null}],"properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"LoadImage"},"widgets_values":["flux_kontext_dev_basic_input_image.jpg","image"]},{"id":186,"type":"MarkdownNote","pos":[-960,500],"size":[510,670],"flags":{},"order":6,"mode":0,"inputs":[],"outputs":[],"title":"Flux Kontext Prompt Techniques","properties":{},"widgets_values":["\n## Flux Kontext Prompt Techniques\n\n### 1. Basic Modifications\n- Simple and direct: `\"Change the car color to red\"`\n- Maintain style: `\"Change to daytime while maintaining the same style of the painting\"`\n\n### 2. Style Transfer\n**Principles:**\n- Clearly name style: `\"Transform to Bauhaus art style\"`\n- Describe characteristics: `\"Transform to oil painting with visible brushstrokes, thick paint texture\"`\n- Preserve composition: `\"Change to Bauhaus style while maintaining the original composition\"`\n\n### 3. Character Consistency\n**Framework:**\n- Specific description: `\"The woman with short black hair\"` instead of \"she\"\n- Preserve features: `\"while maintaining the same facial features, hairstyle, and expression\"`\n- Step-by-step modifications: Change background first, then actions\n\n### 4. Text Editing\n- Use quotes: `\"Replace 'joy' with 'BFL'\"`\n- Maintain format: `\"Replace text while maintaining the same font style\"`\n\n## Common Problem Solutions\n\n### Character Changes Too Much\n‚ùå Wrong: `\"Transform the person into a Viking\"`\n‚úÖ Correct: `\"Change the clothes to be a viking warrior while preserving facial features\"`\n\n### Composition Position Changes\n‚ùå Wrong: `\"Put him on a beach\"`\n‚úÖ Correct: `\"Change the background to a beach while keeping the person in the exact same position, scale, and pose\"`\n\n### Style Application Inaccuracy\n‚ùå Wrong: `\"Make it a sketch\"`\n‚úÖ Correct: `\"Convert to pencil sketch with natural graphite lines, cross-hatching, and visible paper texture\"`\n\n## Core Principles\n\n1. **Be Specific and Clear** - Use precise descriptions, avoid vague terms\n2. **Step-by-step Editing** - Break complex modifications into multiple simple steps\n3. **Explicit Preservation** - State what should remain unchanged\n4. **Verb Selection** - Use \"change\", \"replace\" rather than \"transform\"\n\n## Best Practice Templates\n\n**Object Modification:**\n`\"Change [object] to [new state], keep [content to preserve] unchanged\"`\n\n**Style Transfer:**\n`\"Transform to [specific style], while maintaining [composition/character/other] unchanged\"`\n\n**Background Replacement:**\n`\"Change the background to [new background], keep the subject in the exact same position and pose\"`\n\n**Text Editing:**\n`\"Replace '[original text]' with '[new text]', maintain the same font style\"`\n\n> **Remember:** The more specific, the better. Kontext excels at understanding detailed instructions and maintaining consistency. "],"color":"#432","bgcolor":"#653"},{"id":39,"type":"VAELoader","pos":[-400,390],"size":[337.76861572265625,58],"flags":{},"order":7,"mode":0,"inputs":[{"localized_name":"vaeÂêçÁß∞","name":"vae_name","type":"COMBO","widget":{"name":"vae_name"},"link":null}],"outputs":[{"localized_name":"VAE","name":"VAE","type":"VAE","links":[61,223]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.38","Node name for S&R":"VAELoader","models":[{"name":"ae.safetensors","url":"https://huggingface.co/Comfy-Org/Lumina_Image_2.0_Repackaged/resolve/main/split_files/vae/ae.safetensors","directory":"vae"}]},"widgets_values":["FLUX1/ae.safetensors"]},{"id":37,"type":"UNETLoader","pos":[-400,80],"size":[337.76861572265625,82],"flags":{},"order":8,"mode":0,"inputs":[{"localized_name":"UNetÂêçÁß∞","name":"unet_name","type":"COMBO","widget":{"name":"unet_name"},"link":null},{"localized_name":"Êï∞ÊçÆÁ±ªÂûã","name":"weight_dtype","type":"COMBO","widget":{"name":"weight_dtype"},"link":null}],"outputs":[{"localized_name":"Ê®°Âûã","name":"MODEL","type":"MODEL","links":[58]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.38","Node name for S&R":"UNETLoader","models":[{"name":"flux1-dev-kontext_fp8_scaled.safetensors","url":"https://huggingface.co/Comfy-Org/flux1-kontext-dev_ComfyUI/resolve/main/split_files/diffusion_models/flux1-dev-kontext_fp8_scaled.safetensors","directory":"diffusion_models"}]},"widgets_values":["text2image/FLUX1/flux1-dev-fp8.safetensors","default"]},{"id":8,"type":"VAEDecode","pos":[530,350],"size":[190,46],"flags":{"collapsed":false},"order":20,"mode":0,"inputs":[{"localized_name":"Latent","name":"samples","type":"LATENT","link":52},{"localized_name":"vae","name":"vae","type":"VAE","link":61}],"outputs":[{"localized_name":"ÂõæÂÉè","name":"IMAGE","type":"IMAGE","slot_index":0,"links":[299]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.38","Node name for S&R":"VAEDecode"},"widgets_values":[]},{"id":192,"type":"PreviewImage","pos":[841.638865764731,508.85901836322887],"size":[588.0947173411639,599.1444059014888],"flags":{},"order":21,"mode":0,"inputs":[{"localized_name":"ÂõæÂÉè","name":"images","type":"IMAGE","link":299}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.75","Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":190,"type":"LoadImage","pos":[-380,800],"size":[280,330],"flags":{},"order":9,"mode":0,"inputs":[{"localized_name":"ÂõæÂÉè","name":"image","type":"COMBO","widget":{"name":"image"},"link":null},{"localized_name":"ÈÄâÊã©Êñá‰ª∂‰∏ä‰º†","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"localized_name":"ÂõæÂÉè","name":"IMAGE","type":"IMAGE","links":[297]},{"localized_name":"ÈÅÆÁΩ©","name":"MASK","type":"MASK","links":null}],"properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"LoadImage"},"widgets_values":["C_2.jpg","image"]},{"id":31,"type":"KSampler","pos":[530,40],"size":[320,262],"flags":{},"order":19,"mode":0,"inputs":[{"localized_name":"Ê®°Âûã","name":"model","type":"MODEL","link":58},{"localized_name":"Ê≠£Èù¢Êù°‰ª∂","name":"positive","type":"CONDITIONING","link":57},{"localized_name":"Ë¥üÈù¢Êù°‰ª∂","name":"negative","type":"CONDITIONING","link":238},{"localized_name":"LatentÂõæÂÉè","name":"latent_image","type":"LATENT","link":291},{"localized_name":"ÁßçÂ≠ê","name":"seed","type":"INT","widget":{"name":"seed"},"link":null},{"localized_name":"Ê≠•Êï∞","name":"steps","type":"INT","widget":{"name":"steps"},"link":null},{"localized_name":"cfg","name":"cfg","type":"FLOAT","widget":{"name":"cfg"},"link":null},{"localized_name":"ÈááÊ†∑Âô®ÂêçÁß∞","name":"sampler_name","type":"COMBO","widget":{"name":"sampler_name"},"link":null},{"localized_name":"Ë∞ÉÂ∫¶Âô®","name":"scheduler","type":"COMBO","widget":{"name":"scheduler"},"link":null},{"localized_name":"ÈôçÂô™","name":"denoise","type":"FLOAT","widget":{"name":"denoise"},"link":null}],"outputs":[{"localized_name":"Latent","name":"LATENT","type":"LATENT","slot_index":0,"links":[52]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.38","Node name for S&R":"KSampler"},"widgets_values":[540715754725811,"randomize",20,1,"euler","simple",1]},{"id":38,"type":"DualCLIPLoader","pos":[-400,210],"size":[337.76861572265625,130],"flags":{},"order":10,"mode":0,"inputs":[{"localized_name":"CLIPÂêçÁß∞1","name":"clip_name1","type":"COMBO","widget":{"name":"clip_name1"},"link":null},{"localized_name":"CLIPÂêçÁß∞2","name":"clip_name2","type":"COMBO","widget":{"name":"clip_name2"},"link":null},{"localized_name":"Á±ªÂûã","name":"type","type":"COMBO","widget":{"name":"type"},"link":null},{"localized_name":"ËÆæÂ§á","name":"device","shape":7,"type":"COMBO","widget":{"name":"device"},"link":null}],"outputs":[{"localized_name":"CLIP","name":"CLIP","type":"CLIP","links":[59]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.38","Node name for S&R":"DualCLIPLoader","models":[{"name":"clip_l.safetensors","url":"https://huggingface.co/comfyanonymous/flux_text_encoders/resolve/main/clip_l.safetensors","directory":"text_encoders"},{"name":"t5xxl_fp8_e4m3fn_scaled.safetensors","url":"https://huggingface.co/comfyanonymous/flux_text_encoders/resolve/main/t5xxl_fp8_e4m3fn_scaled.safetensors","directory":"text_encoders"}]},"widgets_values":["clip_l.safetensors","text2image/FLUX1/t5xxl_fp8_e4m3fn_scaled.safetensors","flux","default"]},{"id":6,"type":"CLIPTextEncode","pos":[330,560],"size":[400,220],"flags":{},"order":12,"mode":0,"inputs":[{"localized_name":"clip","name":"clip","type":"CLIP","link":59},{"localized_name":"ÊñáÊú¨","name":"text","type":"STRING","widget":{"name":"text"},"link":null}],"outputs":[{"localized_name":"Êù°‰ª∂","name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[237,294]}],"title":"CLIP Text Encode (Positive Prompt)","properties":{"cnr_id":"comfy-core","ver":"0.3.38","Node name for S&R":"CLIPTextEncode"},"widgets_values":["the women naked"],"color":"#232","bgcolor":"#353"}],"links":[[52,31,0,8,0,"LATENT"],[57,35,0,31,1,"CONDITIONING"],[58,37,0,31,0,"MODEL"],[59,38,0,6,0,"CLIP"],[61,39,0,8,1,"VAE"],[222,42,0,124,0,"IMAGE"],[223,39,0,124,1,"VAE"],[237,6,0,135,0,"CONDITIONING"],[238,135,0,31,2,"CONDITIONING"],[251,146,0,42,0,"IMAGE"],[289,42,0,173,0,"IMAGE"],[291,124,0,31,3,"LATENT"],[292,177,0,35,0,"CONDITIONING"],[293,124,0,177,1,"LATENT"],[294,6,0,177,0,"CONDITIONING"],[297,190,0,146,0,"IMAGE"],[298,191,0,146,1,"IMAGE"],[299,8,0,192,0,"IMAGE"]],"groups":[{"id":1,"title":"Step 1- Load models","bounding":[-410,10,360,450],"color":"#3f789e","font_size":24,"flags":{}},{"id":3,"title":"Step 2 - Upload images","bounding":[-410,480,700,680],"color":"#3f789e","font_size":24,"flags":{}},{"id":5,"title":"Step 3 - Prompt","bounding":[310,480,430,330],"color":"#3f789e","font_size":24,"flags":{}},{"id":6,"title":"Conditioning","bounding":[-30,10,540,250],"color":"#3f789e","font_size":24,"flags":{}}],"config":{},"extra":{"ds":{"scale":0.8651707379313949,"offset":[1621.8762888922408,54.03263607857417]},"frontendVersion":"1.28.7","groupNodes":{},"VHS_latentpreview":false,"VHS_latentpreviewrate":0,"VHS_MetadataImage":true,"VHS_KeepIntermediate":true},"version":0.4}